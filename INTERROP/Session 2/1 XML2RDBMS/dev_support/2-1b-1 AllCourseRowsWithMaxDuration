SELECT E1.*, E2.EDGENAME, E2.TARGETID, EDGEVALUE_TABLE_INT.INTEGERVALUE AS COURSEINTVALUE, EDGEVALUE_TABLE_STRING.STRINGVALUE AS COURSESTRINGVALUE 
FROM EDGETABLE E1
LEFT JOIN EDGETABLE E2
ON E1.TARGETID = E2.SOURCEID
LEFT JOIN EDGEVALUE_TABLE_INT
ON E2.TARGETID = EDGEVALUE_TABLE_INT.INTEGERVALUEID
LEFT JOIN EDGEVALUE_TABLE_STRING
ON E2.TARGETID = EDGEVALUE_TABLE_STRING.STRINGVALUEID
-- select only courses
WHERE E1.EDGENAME = 'course' AND E1.TARGETID IN (-- SELECT DISTINCT SOURCEIDs as COURSEIDs
SELECT DISTINCT E3.SOURCEID AS COURSEID 
FROM EDGETABLE E1
-- join in integer values
LEFT JOIN EDGEVALUE_TABLE_INT EVINT
ON E1.TARGETID = EVINT.INTEGERVALUEID
-- join in string values
LEFT JOIN EDGEVALUE_TABLE_STRING EVSTRING
ON E1.TARGETID = EVSTRING.STRINGVALUEID
-- join in parent level appointment
LEFT JOIN EDGETABLE E2
ON E1.SOURCEID = E2.TARGETID
-- join in parent level course
LEFT JOIN EDGETABLE E3
ON E2.SOURCEID = E3.TARGETID
-- filter with result of subquery to get thoe with max value.
WHERE E1.EDGENAME = '@duration_min' AND EVINT.INTEGERVALUE =
  -- find the max value for duration and filter the list then 
  (SELECT MAX(EDGEVALUE_TABLE_INT.INTEGERVALUE) FROM EDGETABLE
  INNER JOIN EDGEVALUE_TABLE_INT
  ON EDGETABLE.TARGETID = EDGEVALUE_TABLE_INT.INTEGERVALUEID
  WHERE EDGETABLE.EDGENAME = '@duration_min'));